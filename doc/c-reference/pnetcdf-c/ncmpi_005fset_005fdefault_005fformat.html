<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- 
Copyright (C) 2003 Northwertern University and Argonne National
Laboratory.

Portions of this software were developed by the Unidata Program at the
University Corporation for Atmospheric Research.

Access and use of this software shall impose the following obligations and
understandings on the user. The user is granted the right, without any fee or
cost, to use, copy, modify, alter, enhance and distribute this software, and
any derivative works thereof, and its supporting documentation for any purpose
whatsoever, provided that this entire notice appears in all copies of the
software, derivative works and supporting documentation.  Further, Northwestern
University and Argonne National Laboratory request that the user credit
Northwestern University and Argonne National Laboratory in any publications
that result from the use of this software or in any product that includes this
software.  The names Northwestern University and Argonne National Laboratory,
however, may not be used in any advertising or publicity to endorse or promote
any products or commercial entity unless specific written permission is
obtained from Northwestern University and Argonne National Laboratory. The user
also understands that Northwestern University and Argonne National Laboratory
are not obligated to provide the user with any support, consulting, training or
assistance of any kind with regard to the use, operation and performance of
this software nor to provide the user with any updates, revisions, new versions
or "bug fixes."

THIS SOFTWARE IS PROVIDED BY NORTHWESTERN UNIVERSITY AND ARGONNE NATIONAL
LABORATORY "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL NORTHWESTERN UNIVERSITY
AND ARGONNE NATIONAL LABORATORY BE LIABLE FOR ANY SPECIAL, INDIRECT OR
CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE,
DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS
ACTION, ARISING OUT OF OR IN CONNECTION WITH THE ACCESS, USE OR PERFORMANCE OF
THIS SOFTWARE.
 -->
<!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>ncmpi_set_default_format (PnetCDF C Interface Guide)</title>

<meta name="description" content="ncmpi_set_default_format (PnetCDF C Interface Guide)">
<meta name="keywords" content="ncmpi_set_default_format (PnetCDF C Interface Guide)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Combined-Index.html#Combined-Index" rel="index" title="Combined Index">
<link href="Files.html#Files" rel="up" title="Files">
<link href="ncmpi_005fbegin_005findep_005fdata.html#ncmpi_005fbegin_005findep_005fdata" rel="next" title="ncmpi_begin_indep_data">
<link href="ncmpi_005fset_005ffill.html#ncmpi_005fset_005ffill" rel="prev" title="ncmpi_set_fill">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src='https://www.googletagmanager.com/gtag/js?id=G-CJ8LEHVTXW'></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CJ8LEHVTXW');
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45938012-1', 'auto');
  ga('create', 'UA-45937491-1', 'auto', {'name': 'pnetcdfTracker'});
  ga('create', 'UA-46002884-1', 'auto', {'name': 'parallelnetcdfTracker'});

  ga('send', 'pageview');
  ga('pnetcdfTracker.send', 'pageview');
  ga('parallelnetcdfTracker.send', 'pageview');
</script>
</head>

<body lang="en">
<a name="ncmpi_005fset_005fdefault_005fformat"></a>
<div class="header">
<p>
Next: <a href="ncmpi_005fbegin_005findep_005fdata.html#ncmpi_005fbegin_005findep_005fdata" accesskey="n" rel="next">ncmpi_begin_indep_data</a>, Previous: <a href="ncmpi_005fset_005ffill.html#ncmpi_005fset_005ffill" accesskey="p" rel="prev">ncmpi_set_fill</a>, Up: <a href="Files.html#Files" accesskey="u" rel="up">Files</a> &nbsp; [<a href="Combined-Index.html#Combined-Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="Set_002fInquire-Default-Creation-Format_003a-ncmpi_005fset_005fdefault_005fformat-and-ncmpi_005finq_005fdefault_005fformat"></a>
<h3 class="section">2.17 Set/Inquire Default Creation Format: ncmpi_set_default_format and ncmpi_inq_default_format</h3>
<a name="index-ncmpi_005fset_005fdefault_005fformat"></a>
<a name="index-ncmpi_005finq_005fdefault_005fformat"></a>
<a name="index-ncmpi_005fset_005fdefault_005fformat_002c-example"></a>
<a name="index-ncmpi_005finq_005fdefault_005fformat_002c-example"></a>
<a name="index-create-flag_002c-setting-default"></a>
<a name="index-inquiring-default"></a>

<p>This function is intended for advanced users. (1.6.1 and later)
</p>
<p>Starting from netCDF 3.6, a new file format named 64-bit offset format, or
CDF-2, was introduced to relax the limitations on creating very large
files. The older format is referred as CDF-1 format.
</p>
<p>Users are warned that creating files in the 64-bit offset format makes
them unreadable by the netCDF library prior to version 3.6.0. For
reasons of compatibility, users should continue to create files in
CDF-1 format.
</p>
<p>In addition to 64-bit offset format, PnetCDF also supports the 64-bit data
format, which allows variables to be defined with more than 4 billion array
elements. This format is named CDF-5. Similarly, the files in 64-bite data
format cannot be read by the netCDF library version 3.6.0 and all prior to
version 3.6.0.
</p>
<p>Users who do want to use 64-bit offset or 64-bit data format files can create
them directly from ncmpi_create, using the proper cmode flag.
(see <a href="ncmpi_005fcreate.html#ncmpi_005fcreate">ncmpi_create</a>).
</p>
<p>The function ncmpi_set_default_format allows the user to change the
format of the netCDF file to be created by future calls to ncmpi_create
without changing the cmode flag.
</p>
<p>This allows the user to convert a program to use 64-bit offset or data
formation without changing all calls the ncmpi_create. See <a href="../netcdf/Large-File-Support.html#Large-File-Support">Large File
Support</a> in <cite>The PnetCDF Users Guide</cite>.
</p>
<p>Once the default format is set, all future created files will be in
the desired format.
</p>
<p>Constants are provided in the pnetcdf.h file to be used with this
function,
NC_FORMAT_CLASSIC (CDF-1 format),
NC_FORMAT_CDF2 (or NC_FORMAT_64BIT), and
NC_FORMAT_CDF5 (or NC_FORMAT_64BIT_DATA).
</p>
<p>If a non-NULL pointer is provided, it is assumed to point to an integer,
where the existing default format will be written.
</p>
<p>Using ncmpi_create with a cmode including NC_64BIT_OFFSET or NC_64BIT_DATA
overrides the default format, and creates a 64-bit offset (CDF-2) or 64-bit
data (CDF-5) file.
</p>
<a name="Operational-Mode-13"></a>
<h3 class="heading">Operational Mode</h3>
<p>ncmpi_set_default_format is an independent subroutine, but is expected to
be called by all processes that intend to create a file later.
</p>
<p>ncmpi_inq_default_format is an independent subroutine.
</p>
<a name="Usage-13"></a>
<h3 class="heading">Usage</h3>
<div class="example">
<pre class="example">int ncmpi_set_default_format(int  new_format,
                             int *old_formatp);

int ncmpi_inq_default_format(int *formatp);
</pre></div>

<dl compact="compact">
<dt><code>new_format</code></dt>
<dd><p>NC_FORMAT_CLASSIC (the default setting), NC_FORMAT_CDF2 (NC_FORMAT_64BIT),
or NC_FORMAT_CDF5 (NC_FORMAT_64BIT_DATA).
</p>
</dd>
<dt><code>old_formatp</code></dt>
<dd><p>Either NULL (in which case it will be ignored), or a pointer to an int
where the existing default format (i.e. before being changed to the
new format) will be written. This allows you to get the existing
default format while setting a new default format.
</p>
</dd>
<dt><code>formatp</code></dt>
<dd><p>The current setting for default file format.
</p>
</dd>
</dl>

<a name="Return-Error-Codes-10"></a>
<h3 class="heading">Return Error Codes</h3>
<p>ncmpi_set_default_format returns the value NC_NOERR if no errors
occurred. Otherwise, the returned status indicates an error. Possible
causes of errors include:
</p><ul>
<li> NC_EINVAL: For ncmpi_set_default_format(), this indicates an invalid
new default format is used. The only valid formats are
NC_FORMAT_CLASSIC (CDF-1 format), NC_FORMAT_CDF2 (NC_FORMAT_64BIT),
and NC_FORMAT_CDF5 (NC_FORMAT_64BIT_DATA).
Trying to set the default format to something else
will result in an invalid argument error.
For ncmpi_inq_default_format, this error indicates NULL pointer is used.
</li><li> NC_EMULTIDEFINE_OMODE: the values of new_format are inconsistent among processes.
</li></ul>

<a name="Example-12"></a>
<h3 class="heading">Example</h3>

<p>Here is an example using ncmpi_set_default_format to create files
in CDF-1, CDF-2, and CDF-5 formats with the same ncmpi_create call:
</p>
<div class="example">
<pre class="example">#include &lt;pnetcdf.h&gt;
   ...
int i, ncid;
int format[3] = {NC_FORMAT_CLASSIC, NC_FORMAT_CDF2, NC_FORMAT_CDF5};
   ...
for (i=0; i&lt;3; i++) {
    status = <a href="#ncmpi_005fset_005fdefault_005fformat">ncmpi_set_default_format</a>(format[i], NULL);
    if (status != NC_NOERR) handle_error(status);

    status = <a href="ncmpi_005fcreate.html#ncmpi_005fcreate">ncmpi_create</a>(MPI_COMM_WORLD, &quot;foo.nc&quot;, NC_CLOBBER, MPI_INFO_NULL,  &amp;ncid);
    if (status != NC_NOERR) handle_error(status);
   ...
}
</pre></div>

<hr>
<div class="header">
<p>
Next: <a href="ncmpi_005fbegin_005findep_005fdata.html#ncmpi_005fbegin_005findep_005fdata" accesskey="n" rel="next">ncmpi_begin_indep_data</a>, Previous: <a href="ncmpi_005fset_005ffill.html#ncmpi_005fset_005ffill" accesskey="p" rel="prev">ncmpi_set_fill</a>, Up: <a href="Files.html#Files" accesskey="u" rel="up">Files</a> &nbsp; [<a href="Combined-Index.html#Combined-Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
